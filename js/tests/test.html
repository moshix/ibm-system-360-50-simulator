<!DOCTYPE html>
<html>
<!--
This file holds unittests for viewer.js, using qunit
-->
<head>
  <meta charset="utf-8">
  <title>wwsim unittests</title>
  <link rel="stylesheet" href="qunit-2.6.2.css" >
  <script type=text/javascript>
  // Stub out jquery
  $ = function() {
    return {
      ready: function() { }
    };
  };
  </script>
  <script src="data.js"></script>
  <script src="../viewer.js"></script>
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>

  <div id="div"></div>
  <div id="div2"></div>

  <script src="qunit-2.6.2.js"></script>
  <script>

    QUnit.test( "padbox", function(assert) {
    var result = [];
    padbox(result, 'A', undefined, undefined);
    padbox(result, 'A', 'abc');
    padbox(result, 'A', 'abc', 'def');
    padbox(result, 'A', 'abc', 'defghijk');
    padbox(result, 'A', undefined, 'def');
    padbox(result, 'A', undefined, 'defghijk');
    assert.deepEqual(result,
        [
          "A             |",
          "A abc         |",
          "A abc   def   |",
          "A abc defghijk|",
          "A       def   |",
          "A     defghijk|"
        ]);

    });


tests = {
// QA110
"0100": ["---------- 0100","E 0111        |","B W67→MB      |","D IA→H        |","L FN,J→LSA    |","L LS→R→LS     |","C S03.¬E      |","R M(47)→ROAR  |","----****XX ----","Next: 0182"],
"0101": ["---------- 0101","E 0111        |","B W67→MB      |","D IA→H        |","L FN,J→LSA    |","L LS→R→LS     |","C S03.¬E      |","R M(47)→ROAR  |","----****XX ----","Next: 0182"],
"0110": ["---------- 0110","A M23+L→R     |","L FN,J→LSA    |","L LS→L→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0122"],
"0111": ["---------- 0111","A M23→R       |","L FN,J→LSA    |","L LS→L→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0122"],
"0122": ["---------- 0122","A R+L→L       |","B W67→MB      |","D IA→H        |","D 3→LB        |","L FN,MD→LSA   |","L LS→R→LS     |","C E→S03       |","R M(47)→ROAR  |","----****XX ----","Next: 0700"],
// QA111
"0104": ["---------- 0104","L FN,J→LSA    |","L LS→L→LS     |","R M(47)→ROAR  |","|             |","|             |","|             |","----****XX ----","Next: 0280"],
// QA400
"0192": ["---------- 0192","B W→G         |","D 0→LB        |","L FN,MD→LSA   |","L LS→L→LS     |","|             |","|             |","----    XX ----","Next: 0126"],
"0126": ["---------- 0126","E 1110        |","B LLB→U       |","B U→W         |","B W27→PSW4    |","L WS,E→LSA    |","L LS→L→LS     |","S IA+0/2→A    |","C E→S47       |","R I-FETCH     |","----    ** ----","Next: 0148"],
"01aa": ["---------- 01AA","E 1000        |","A E→R         |","A       SL1→Q |","B       MLB→V |","B V→W         |","B WM→MD,F     |","----    XX ----","Next: 019c"],
// QA500
"0196": ["---------- 0196","A H→R         |","B PSW4→U      |","B U→W         |","B W→MMB       |","L FN,J→LSA    |","L LS→L→LS     |","R          S0 |","----    X* ----","Next: 010a"],
"0714": ["---------- 0714","A H→R         |","B PSW4→U      |","B U→W         |","B W→MMB       |","|             |","|             |","----    XX ----","Next: 010a"],
"010a": ["---------- 010A","A M→R0        |","L FN,MD→LSA   |","L R→LS        |","|             |","|             |","|             |","----    XX ----","Next: 01c6"],
"010b": ["---------- 010B","A M→R0        |","L FN,MD→LSA   |","L R→LS        |","S IA+0/2→A    |","R SMIF        |","R I-FETCH     |","----    ** ----","Next: 0144"],
// QA700
"071c": ["---------- 071C","|             |","| NOP         |","|             |","|             |","|             |","R CRMD      0 |","----    *X ----","Next: 01c4"],
"019e": ["---------- 019E","A R→L         |","R AΩ(B=1)→A   |","|             |","|             |","|             |","R CRMD     S0 |","----    ** ----","Next: 01c4"],
"019a": ["---------- 019A","A R→L         |","L FN,MD→LSA   |","L LS→R→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0718"],
"0718": ["---------- 0718","A R-1→R       |","L FN,MD→LSA   |","L R→LS        |","|             |","|             |","R S0        1 |","----    *X ----","Next: 01c5"],
"01c7": ["---------- 01C7","E 1110        |","L WS,E→LSA    |","L LS→L→LS     |","S IA+0/2→A    |","C E→S47       |","R I-FETCH     |","----    ** ----","Next: 0148"],
"01c5": ["---------- 01C5","A L→R         |","|             |","|             |","|             |","|             |","R TZ*BS       |","----    *X ----","Next: 0715"],
// QA800
"01a2": ["---------- 01A2","B R3→U        |","B U→W         |","D 3→LB        |","L FN,MD→LSA   |","L LS→L→LS     |","C E(13)→WFN   |","R PROB      1 |","----    *X ----","Next: 0181"],
// Note: extra 0, extra UL->WL
"0181": ["---------- 0181","B LLB→U       |","B UL→WL ?→WR  |","B WR→F        |","|             |","|             |","R 0      WR=0 |","----    X* ----","Next: 01c8"],
"01c9": ["---------- 01C9","A R→A         |","C F→KEY       |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01bc"],
"01bc": ["---------- 01BC","E 0110        |","A R+E→A       |","C F→KEY       |","|             |","|             |","|             |","----    XX ----","Next: 092f"],
// QJ150
"073e": ["---------- 073E","A R→M         |","A       SR1→Q |","B R3→U        |","B U→W         |","B W67→LB      |","D 3→MB        |","L WS1→LSA     |","L L→LS        |","C L(0)→LSGNS  |","R MD3=0     0 |","----    *X ----","Next: 08c0"],
"0899": ["---------- 0899","E 0010        |","A SGN→M       |","A       SR4→F |","D 0→MB        |","C E(13)→WFN   |","|             |","----    XX ----","Next: 021b"],
"089c": ["---------- 089C","E 1111        |","A L→T         |","R BΩ(A=0)→B   |","|             |","|             |","R WR=0     S3 |","----    ** ----","Next: 0898"],
"089e": ["---------- 089E","A R→L         |","A       SL1→Q |","L WS1→LSA     |","L LS→R→LS     |","|             |","|             |","----    XX ----","Next: 08ce"],
"089f": ["---------- 089F","A -L→R        |","A BCO         |","D HOT1→ADDER  |","L FN,MD→LSA   |","L LS→L→LS     |","R 0      T(0) |","----    X* ----","Next: 08c4"],
"08a2": ["---------- 08A2","A -L→R        |","A BCO         |","B       MMB→V |","B       VR→WR |","B WR→G2       |","D HOT1→ADDER  |","L WS1→LSA     |","L LS→L→LS     |","----    XX ----","Next: 08c1"],
"08a3": ["---------- 08A3","A -L→R        |","A BCO         |","B       MMB→V |","B       VR→WR |","B WR→G2       |","D HOT1→ADDER  |","L WS1→LSA     |","L LS→L→LS     |","----    XX ----","Next: 08c3"],
"08c0": ["---------- 08C0","E 0110        |","B       E→WR  |","B WM→MD,F     |","|             |","|             |","|             |","----    XX ----","Next: 0195"],
"08c1": ["---------- 08C1","A -L→L        |","A BCVC        |","D CSTAT→ADDER |","L WS1→LSA     |","L L→LS        |","|             |","----    XX ----","Next: 089e"],
"08c2": ["---------- 08C2","E 0001        |","A M→M         |","A       SR1→Q |","B WR→F        |","D LB-1        |","L FN,MDΩ1→LSA |","L LS→L→LS     |","C E(13)→WFN   |","R L(0)   LB=0 |","----    ** ----","Next: 08a0"],
"08c4": ["---------- 08C4","E 0001        |","A -L→L        |","A       -SGN→ |","B       MMB→V |","B       VR→WR |","D CSTAT→ADDER |","L FN,MDΩ1→LSA |","L R→LS        |","C E(23)→CR    |","----    XX ----","Next: 08c7"],
"08c5": ["---------- 08C5","E 0001        |","A -L→L        |","A BCVC  -SGN→ |","B       MMB→V |","B       VR→WR |","D CSTAT→ADDER |","L FN,MDΩ1→LSA |","L R→LS        |","C E(23)→CR    |","R       (CAR) |","----    X* ----","Next: 08c6"],
"08c7": ["---------- 08C7","L FN,MD→LSA   |","L L→LS        |","|             |","|             |","|             |","R WR=0      1 |","----    *X ----","Next: 0881"],
"08ca": ["---------- 08CA","A L→L         |","A       SL4→F |","B MD,F→U MMB→V|","B UL→WL ?→WR  |","B W→MMB       |","|             |","----    XX ----","Next: 08cd"],
"08cb": ["---------- 08CB","A R→T         |","B MD,F→U MMB→V|","B UL→WL ?→WR  |","B W→MMB       |","L FN,MD→LSA   |","L R→LS        |","C SETCRALG    |","R BΩ(A=1)→B   |","R LSGNS  T(0) |","----    ** ----","Next: 089c"],
"08cc": ["---------- 08CC","A L→R         |","B W→MMB       |","D G2-1        |","L WS1→LSA     |","L LS→L→LS     |","R        G2=0 |","----    X* ----","Next: 08ca"],
"08cd": ["---------- 08CD","A R→R         |","A      F→SL4→F|","D G2-1        |","L FN,MDΩ1→LSA |","L L→LS        |","C (T=0)→S3    |","R        G2=0 |","----    X* ----","Next: 08ca"],
// QP100
"0614": ["---------- 0614","A L→A         |","L WS2→LSA     |","L LS→R→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0626"],
// QP206
"0d95": ["---------- 0D95","A R-1→L13     |","L FN,J→LSA    |","L L→LS        |","|             |","|             |","|             |","----    XX ----","Next: 0197"],
// QT105
"0146": ["---------- 0146","E 1111        |","B W→G         |","C E(23)→LSFN  |","|             |","|             |","R 1       IVA |","----    X* ----","Next: 014e"],
"0144": ["---------- 0144","E 1110        |","L WS,E→LSA    |","L LS→L→LS     |","S IA+0/2→A    |","C E→S47       |","R I-FETCH     |","----    ** ----","Next: 0148"],
// QT110
"0148": ["---------- 0148","E 1111        |","A LRL→MLJK    |","B W67→LB      |","D 3→MB        |","C E(23)→LSFN  |","R BΩ(A=1)→B   |","R 1SYLS   IVA |","----    ** ----","Next: 0184"],
"014a": ["---------- 014A","E 1111        |","B W→G         |","C E(23)→LSFN  |","|             |","|             |","R 1       IVA |","----    X* ----","Next: 014e"],
// QT115
"014f": ["---------- 014F","E 0101        |","A 0→MLJK      |","B       E→WR  |","B WR→F        |","C IA+2        |","|             |","----    XX ----","Next: 0195"],
"0187": ["---------- 0187","E 1111        |","A M→MD        |","B W→G         |","D LB+1        |","C IA+2/4 E→BS |","R M(03)→ROAR  |","----****XX ----","Next: 0100"],
// NOTE: doc shows IA/2+4
"0188": ["---------- 0188","E 1111        |","A M→MD        |","B       MMB→V |","B       VR→WR |","B W→MMB       |","D LB,MB+1     |","L FN,MD→LSA   |","L LS→L→LS     |","C IA+2/4 E→BS |","R M(03)→ROAR  |","R RX,S0    S1 |","----****** ----","Next: 0100"],
// QT120
"0102": ["---------- 0102","E 1111        |","A R→IA        |","B W67→LB      |",
"D IA→H        |",
"D 3→MB        |",
"C E(23)→LSFN  |",
"R AΩ(B=1)→A   |",
"R S3      IVA |","----    ** ----","Next: 01cc"],
"018b": ["---------- 018B","E 0110        |","A 0→MLJK      |","B       E→WR  |","B WR→F        |","C IA+2        |","|             |","----    XX ----","Next: 0195"],
"01cc": ["---------- 01CC","E 1110        |","B W→G         |","D D→MLJK      |","D MB-1        |","L WS,E→LSA    |","L L→LS        |","C E→S47       |","R BΩ(A=1)→B   |","R R(31)     0 |","----    *X ----","Next: 0188"],
"01cf": ["---------- 01CF","E 0101        |","A 0→MLJK      |","B       E→WR  |","B WR→F        |","C IA+2        |","|             |","----    XX ----","Next: 0195"],
"01ce": ["---------- 01CE","B W→G         |","D D→L         |","D LB+1        |","C B0,1SYL     |","R R(31)     1 |","|             |","----    *X ----","Next: 0189"],
// QT200
"0103": ["---------- 0103","A R→IA        |","C 1→REFETCH   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"],
"0191": ["---------- 0191","A 0→M,SP      |","D IA→H        |","D 3→LB,MB     |","C OPPANEL→S47 |","R BΩ(A=1)→B   |","R EXT,CHIRPT  |","----    *X ----","Next: 018c"],
"018c": ["---------- 018C","A H→R         |","D LB-1        |","|             |","|             |","|             |","R S4       S5 |","----    ** ----","Next: 0208"],
"0208": ["---------- 0208","|             |","| NOP         |","|             |","|             |","|             |","R S6       S7 |","----    ** ----","Next: 0150"],
"0150": ["---------- 0150","C MANUAL→STOP |","|             |","|             |","|             |","|             |","R 0       EXC |","----    X* ----","Next: 0190"],
"0190": ["---------- 0190","E 0111        |","D IA→H        |","L WS,E→LSA    |","L LS→L→LS     |","|             |","|             |","----    XX ----","Next: 0193"],
"0147": ["---------- 0147","A 0→M,SP      |","D IA→H        |","D 3→LB,MB     |","C OPPANEL→S47 |","R BΩ(A=1)→B   |","R EXT,CHIRPT  |","----    *X ----","Next: 018c"],
"0152": ["---------- 0152","B WR→F        |","D AKEY→R      |","C MANUAL→STOP |","|             |","|             |","|             |","----    XX ----","Next: 0103"],
"0209": ["---------- 0209","D AKEY→L      |","C MANUAL→STOP |","R S6        0 |","|             |","|             |","|             |","----    *X ----","Next: 0154"],
"0156": ["---------- 0156","D DKEY→T      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"],
"0107": ["---------- 0107","C SYNC→OPPANEL|","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0106"],
"0193": ["---------- 0193","A L→M,SP      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0106"],
// QT210
"01a3": ["---------- 01A3","A M→R         |","B W→MMB       |","D MB-1        |","L WS1→LSA     |","L R→LS        |","|             |","----    XX ----","Next: 0198"],
"0198": ["---------- 0198","E 0110        |","A R→A         |","B       E→WR  |","B W→MMB       |","|             |","|             |","----    XX ----","Next: 01a0"],
"01a0": ["---------- 01A0","A M→L         |","B WR→F        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01a4"],
"01a4": ["---------- 01A4","D D→R         |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01cb"],
// QT220
"020f": ["---------- 020F","D DKEY→T      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02bf"],
"02bf": ["---------- 02BF","D AKEY→R,AN   |","C F→KEY       |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"],
"020a": ["---------- 020A","C MANUAL→STOP |","R BΩ(A=0)→B   |","R S6       S7 |","|             |","|             |","|             |","----    ** ----","Next: 020c"],
"020e": ["---------- 020E","D AKEY→R,AN   |","C KEY→F       |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02bb"],
"02bb": ["---------- 02BB","|             |","| NOP         |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02be"],
"02be": ["---------- 02BE","C KEY→F       |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"],
"020d": ["---------- 020D","D AKEY→R,AN   |","R S7        1 |","|             |","|             |","|             |","|             |","----    *X ----","Next: 0235"],
// QT300
"0142": ["---------- 0142","E 0100        |","B       E→WR  |","B WM→MD,F     |","|             |","|             |","|             |","----    XX ----","Next: 0195"],
// QT310
"010e": ["---------- 010E","E 1100        |","A M→D         |","C F→SCANCTL   |","|             |","|             |","|             |","----    XX ----","Next: 010f"],
"010f": ["---------- 010F","A R+L→R,A     |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0751"],
"0195": ["---------- 0195","E 1010        |","A E→R         |","A       SL1→Q |","|             |","|             |","|             |","----    XX ----","Next: 019c"],
"01b3": ["---------- 01B3","A H→M         |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01b5"],
"01b4": ["---------- 01B4","A R→R,A       |","B W→MMB       |","D 3→MB        |","|             |","|             |","|             |","----    XX ----","Next: 01b8"],
"01b5": ["---------- 01B5","A L→A         |","B PSW4→U      |","B U→W         |","B W→MMB       |","|             |","|             |","----    XX ----","Next: 01b7"],
"01b7": ["---------- 01B7","E 0010        |","A E→L         |","A       SL4→F |","L WS1→LSA     |","L LS→R→LS     |","|             |","----    XX ----","Next: 010e"],
"01b8": ["---------- 01B8","A R+4→L       |","B MD,F→U      |","B U→W         |","B W→MMB       |","L WS1→LSA     |","L R→LS        |","----    XX ----","Next: 01b1"],
// QU100
"0242": ["---------- 0242","E 1000        |","A 0→L         |","C SCAN*E,00   |","|             |","|             |","|             |","----    XX ----","Next: 02ba"],
"02ba": ["---------- 02BA","A 0→H         |","D 3→MD        |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 02b2"],
"0240": ["---------- 0240","E 1000        |","A 0→L         |","D 3→MD        |","C T→PSW,IPL→T |","|             |","|             |","----    XX ----","Next: 02af"],
"02af": ["---------- 02AF","E 1111        |","A 0→H         |","L WS1→LSA     |","L L→LS        |","C E→S03       |","|             |","----    XX ----","Next: 02b2"],
"02c2": ["---------- 02C2","E 1000        |","A 0→L         |","D 0→MD        |","C SCAN*E,00   |","|             |","|             |","----    XX ----","Next: 02af"],
"02b2": ["---------- 02B2","A 0→M,SP      |","B WL→J        |","D 0→LB,MB     |","C SCAN*E,00   |","R AΩ(B=0)→A   |","R PSS       0 |","----    *X ----","Next: 0280"],
"0282": ["---------- 0282","E 0111        |","A -1→R        |","B       E→WR  |","B W→MMB       |","C E(0)→IBFULL |","|             |","----    XX ----","Next: 02d0"],
"02d0": ["---------- 02D0","A 0→IA        |","B R3→U        |","B U→W         |","B W,E→A(BUMP) |","D 3→LB        |","L FN,J→LSA    |","L LS→L→LS     |","C E(23)→LSFN  |","----    XX ----","Next: 02b3"],
"02d1": ["---------- 02D1","E 0010        |","B R3→U        |","B U→W         |","B W,E→A(BUMP) |","D 3→MB        |","L FN,J→LSA    |","L LS→L→LS     |","C E(23)→LSFN  |","----    XX ----","Next: 02b3"],
"02b6": ["---------- 02B6","A M→D         |","B W→G         |","|             |","|             |","|             |","R MB=3   LB=3 |","----    ** ----","Next: 02d0"],
"0241": ["---------- 0241","A 0→D         |","B R3→U        |","B U→W         |","B WL→J        |","|             |","|             |","----    XX ----","Next: 02d0"],
"0243": ["---------- 0243","E 0011        |","A 0→D         |","D 0→LB,MB     |","L FN,J→LSA    |","L LS→L→LS     |","C F→SCANCTL   |","R S3     MD=0 |","----    ** ----","Next: 0204"],
"0207": ["---------- 0207","A 0→R,A       |","C MANUAL→STOP |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0751"],
"0204": ["---------- 0204","A L→T         |","B LLB→U       |","B U→W         |","B W→PSW0      |","C T→PSW       |","|             |","----    XX ----","Next: 0150"],
// QW111
"0204": ["---------- 0204","A L→T         |","B LLB→U       |","B U→W         |","B W→PSW0      |","C T→PSW       |","|             |","----    XX ----","Next: 0150"],
"0001": ["---------- 0001","A R-L→T       |","A undef!!!AD  |","L undef!!!WS  |","|             |","|             |","|             |","----    XX ----","Next: 003c"],
"0010": ["---------- 0010","A undef!!!AD  |","L undef!!!WS  |","L LS→R→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0aab"],
"0202": ["---------- 0202","D AKEY→A      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0203"],
"0203": ["---------- 0203","D AKEY→IA     |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0205"],
"0205": ["---------- 0205","D DKEY→L      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 020c"],
"020c": ["---------- 020C","D DKEY→R      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 021f"],
"021f": ["---------- 021F","D DKEY→H      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0283"],
"0283": ["---------- 0283","D DKEY→M      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02aa"],
"02aa": ["---------- 02AA","D DKEY→D      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02ab"],
"02ab": ["---------- 02AB","D DKEY→J      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02ae"],
"02ae": ["---------- 02AE","D DKEY→MD     |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0202"],
"0200": ["---------- 0200","D DKEY→D      |","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0200"],
// Has MD/1 instead of MD+1, missing R->Z
// "0201": ["---------- 0201","A AR->Z and D DKEY→L      |","D MD+1        |","L FN,MD→LSA   |","L LS→R,L→LS   |","|             |","|             |","----    XX ----","Next: 0201"],

// QW222: all 1's and all 0's
// QY110
// QY510
"0f4c": ["---------- 0F4C","D D→IAR       |","C SCAN*E,00   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f8f"],
"0fcd": ["---------- 0FCD","E 0010        |","S HA→A        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f8d"],

};
    QUnit.test( "box", function(assert) {
      var keys = Object.keys(tests);
      for (var i = 0; i < keys.length; i++) {
        var key = keys[i];
        var result = box(key, testdata[key]);
        var wanted = tests[key];
        // Don't check empty lines
        result = result.filter(line => line !=  "|             |");
        wanted = wanted.filter(line => line !=  "|             |");
        // Ignore spacing
        result = result.map(line => line.replace(/\s+/g, ' '));
        wanted = wanted.map(line => line.replace(/\s+/g, ' '));

        assert.deepEqual(result, wanted);
      }
    });

  </script>
</body>
</html>
