// Tests for decode.cpp
#include <iostream>
#include "catch.hpp"
#include "decode.hpp"
#include "entry.hpp"

std::vector<std::string> padbox_wanted = {
    "A             |",
    "A abc         |",
    "A abc   def   |",
    "A a→c   d→f   |",
    "A abc defghijk|",
    "A       def   |",
    "A     defghijk|",
    "A abcdefghijkl m|"
};

TEST_CASE( "padbox") {
    std::vector<std::string> result;
    padbox(result, "A", "", "");
    padbox(result, "A", "abc");
    padbox(result, "A", "abc", "def");
    padbox(result, "A", "a→c", "d→f");
    padbox(result, "A", "abc", "defghijk");
    padbox(result, "A", "", "def");
    padbox(result, "A", "", "defghijk");
    padbox(result, "A", "abcdefghijkl", "m");
    for (int i = 0; i < result.size(); i++) {
        REQUIRE(result[i] == padbox_wanted[i]);
    }
}

typedef struct Test {
    int address;
    std::vector<std::string> wantedOutput;
} Test;

std::vector<Test> tests = {
    // QA110
    {0x0100,  {"---------- 0100","E 0111        |","B W67→MB      |","D IA→H        |","L FN,J→LSA    |","L LS→R→LS     |","C S03.¬E      |","R M(47)→ROAR  |","----****XX ----","Next: 0182"}},
    {0x0101,  {"---------- 0101","E 0111        |","B W67→MB      |","D IA→H        |","L FN,J→LSA    |","L LS→R→LS     |","C S03.¬E      |","R M(47)→ROAR  |","----****XX ----","Next: 0182"}},
    {0x0110,  {"---------- 0110","A M23+L→R     |","L FN,J→LSA    |","L LS→L→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0122"}},
    {0x0111,  {"---------- 0111","A M23→R       |","L FN,J→LSA    |","L LS→L→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0122"}},
    {0x0122,  {"---------- 0122","A R+L→L       |","B W67→MB      |","D IA→H        |","D 3→LB        |","L FN,MD→LSA   |","L LS→R→LS     |","C E→S03       |","R M(47)→ROAR  |","----****XX ----","Next: 0700"}},
    // QA111
    {0x0104,  {"---------- 0104","L FN,J→LSA    |","L LS→L→LS     |","R M(47)→ROAR  |","|             |","|             |","|             |","----****XX ----","Next: 0280"}},
    // QA400
    {0x0192,  {"---------- 0192","B W→G         |","D 0→LB        |","L FN,MD→LSA   |","L LS→L→LS     |","|             |","|             |","----    XX ----","Next: 0126"}},
    {0x0126,  {"---------- 0126","E 1110        |","B LLB→U       |","B U→W         |","B W27→PSW4    |","L WS,E→LSA    |","L LS→L→LS     |","S IA+0/2→A    |","C E→S47       |","R I-FETCH     |","----    ** ----","Next: 0148"}},
    {0x01aa,  {"---------- 01AA","E 1000        |","A E→R         |","A       SL1→Q |","B       MLB→V |","B V→W         |","B W→MD,F      |","----    XX ----","Next: 019c"}},
    // QA500
    {0x0196,  {"---------- 0196","A H→R         |","B PSW4→U      |","B U→W         |","B W→MMB       |","L FN,J→LSA    |","L LS→L→LS     |","R          S0 |","----    X* ----","Next: 010a"}},
    {0x0714,  {"---------- 0714","A H→R         |","B PSW4→U      |","B U→W         |","B W→MMB       |","|             |","|             |","----    XX ----","Next: 010a"}},
    {0x010a,  {"---------- 010A","A M→R0        |","L FN,MD→LSA   |","L R→LS        |","|             |","|             |","|             |","----    XX ----","Next: 01c6"}},
    {0x010b,  {"---------- 010B","A M→R0        |","L FN,MD→LSA   |","L R→LS        |","S IA+0/2→A    |","R SMIF        |","R I-FETCH     |","----    ** ----","Next: 0144"}},
    // QA700
    {0x071c,  {"---------- 071C","|             |","| NOP         |","|             |","|             |","|             |","R CRMD      0 |","----    *X ----","Next: 01c4"}},
    {0x019e,  {"---------- 019E","A R→L         |","R AΩ(B=1)→A   |","|             |","|             |","|             |","R CRMD     S0 |","----    ** ----","Next: 01c4"}},
    {0x019a,  {"---------- 019A","A R→L         |","L FN,MD→LSA   |","L LS→R→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0718"}},
    {0x0718,  {"---------- 0718","A R-1→R       |","L FN,MD→LSA   |","L R→LS        |","|             |","|             |","R S0        1 |","----    *X ----","Next: 01c5"}},
    {0x01c7,  {"---------- 01C7","E 1110        |","L WS,E→LSA    |","L LS→L→LS     |","S IA+0/2→A    |","C E→S47       |","R I-FETCH     |","----    ** ----","Next: 0148"}},
    {0x01c5,  {"---------- 01C5","A L→R         |","|             |","|             |","|             |","|             |","R TZ*BS       |","----    *X ----","Next: 0715"}},
    // QA800
    {0x01a2,  {"---------- 01A2","B R3→U        |","B U→W         |","D 3→LB        |","L FN,MD→LSA   |","L LS→L→LS     |","C E(13)→WFN   |","R PROB      1 |","----    *X ----","Next: 0181"}},
    // Note: extra 0, extra UL->WL
    {0x0181,  {"---------- 0181","B LLB→U       |","B UL→WL ?→WR  |","B WR→F        |","|             |","|             |","R 0      WR=0 |","----    X* ----","Next: 01c8"}},
    {0x01c9,  {"---------- 01C9","A R→A         |","C F→KEY       |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01bc"}},
    {0x01bc,  {"---------- 01BC","E 0110        |","A R+E→A       |","C F→KEY       |","|             |","|             |","|             |","----    XX ----","Next: 092f"}},
    // QB400
    {0x023a,  {"---------- 023A","A M→L         |","A BC0         |","L FN,MD→LSA   |","L L→LS        |","S IA+0/2→A    |","C CAR,(T≠0)→CR|","R SMIF        |","R I-FETCH     |","----    ** ----","Next: 0144"}},
    // QB500
    {0x0246,  {"---------- 0246","A R-L→T       |","A BC0         |","D HOT1→ADDER  |","S IA+0/2→A    |","C SETCRLOG    |","R SMIF        |","R I-FETCH     |","----    ** ----","Next: 0144"}},
    // QB901
    {0x022f,  {"---------- 022F","A R→R         |","A      F→SR1→Q|","|             |","|             |","|             |","|             |","----    XX ----","Next: 0256"}},
    {0x02a2,  {"---------- 02A2","A R-L→R       |","A      F→SL1→F|","D HOT1→ADDER  |","|             |","|             |","R G1=0  (Z00) |","----    ** ----","Next: 022c"}},
    {0x0257,  {"---------- 0257","A -L→R        |","L FN,MDΩ1→LSA |","L LS→L,R→LS   |","|             |","|             |","R ⩝SGNS  T(0) |","----    ** ----","Next: 0230"}},
    // QE802
    {0x081a,  {"---------- 081A","A R+L→R       |","A DDC0 F→SL1→Q|","L WS,E→LSA    |","L L→LS        |","|             |","|             |","----    XX ----","Next: 0820"}},
    {0x0825,  {"---------- 0825","E 0011        |","A M+L→M       |","A DDC0 Q→SL1  |","L WS,E→LSA    |","L L→LS        |","|             |","----    XX ----","Next: 082e"}},
    // QE900
    {0x073c,  {"---------- 073C","A L→R,AD      |","L WS1→LSA     |","L L→LS        |","|             |","|             |","|             |","----    XX ----","Next: 0848"}},
    {0x0853,  {"---------- 0853","E 0100        |","A H→H         |","A DHH SR1→Q   |","L WS,E→LSA    |","L L→LS        |","R 1       T=0 |","----    X* ----","Next: 083e"}},
    {0x083e,  {"---------- 083E","A R→R         |","A DHL Q→SR1→F |","D LB-1        |","R AΩ(B=0)→A   |","|             |","R S5     LB=0 |","----    ** ----","Next: 081c"}},
    // QE901
    {0x0821,  {"---------- 0821","E 0100        |","A R-L→R       |","A DHL SR1→F   |","B MD,F→U      |","B VL→WL       |","B W→MMB       |","D LB-1        |","D HOT1→ADDER  |","C S47ΩE       |","R AΩ(B=1)→A   |","R 0       T=0 |","----    X* ----","Next: 0824"}},
    // QG010
    {0x011a,  {"---------- 011A","E 1110        |","A M23+L→R,AD  |","L WS1→LSA     |","L R→LS        |","C E→S03       |","R MD=FP     1 |","----    *X ----","Next: 09c5"}},
    // QG100
    {0x01bd,  {"---------- 01BD","E 1000        |","A L→T         |","L FN,MD→LSA   |","L LS→R,L→LS   |","C E→S47       |","R AΩ(B=1)→A   |","R CSTAT MD/JI |","----    ** ----","Next: 0340"}},
    // QG401
    {0x04c0,  {"---------- 04C0","E 0010        |","A R→L         |","A      FPSR4→F|","B E→WL  UR→WR |","B WL→J        |","L WS1→LSA     |","L LS→R,L→LS   |","C ¬S4,S4→CR   |","----    XX ----","Next: 0400"}},
    {0x0440,  {"---------- 0440","A R-L→T       |","A BC1B 1→FPSR4→F|","D 0→MB        |","C S47,ED*FP   |","|             |","R 0     (CAR) |","----    X* ----","Next: 04c0"}},
    {0x0404,  {"---------- 0404","E 0001        |","A L→M         |","A      F→SR4→F|","L WS1→LSA     |","L LS→R→LS     |","C E(23)→LSFN  |","----    XX ----","Next: 0414"}},
    {0x0414,  {"---------- 0414","D D→L         |","D 0→MB        |","R ED→ROAR     |","|             |","|             |","|             |","----****XX ----","Next: 0401"}},
    // QG406
    {0x0486,  {"---------- 0486","A -L→L        |","A BCFO L0,¬S4→|","L FN,MD→LSA   |","L L→LS        |","C S4,¬S4→CR   |","R F→ROAR      |","----****XX ----","Next: 0403"}},
    {0x0455,  {"---------- 0455","E 1111        |","A R-L→L       |","A BC8 L0,S4→  |","B E→W         |","B W→MMB       |","D HOT1→ADDER  |","C FPZERO      |","R S2    (CAR) |","----    ** ----","Next: 0484"}},
    {0x048f,  {"---------- 048F","A R-1→L       |","A BC1B FPSL4  |","D HOT1→ADDER  |","L FN,MD→LSA   |","L R→LS        |","C 0→RSGNS     |","R BΩ(A=0)→B   |","R UNORM (CAR) |","----    ** ----","Next: 03b4"}},
    {0x0488,  {"---------- 0488","C ¬S4,S4→CR   |","|             |","|             |","|             |","|             |","R S0     LB=0 |","----    ** ----","Next: 04b0"}},
    {0x0c3e,  {"---------- 0C3E","E 1101        |","A L→L         |","A       +SGN→ |","B       E→WR  |","B W→MD,F      |","L FN,MD→LSA   |","L L→LS        |","----    XX ----","Next: 0195"}},
    {0x0487,  {"---------- 0487","A M+L→R       |","A BC1B F→FPSL4|","L FN,MD→LSA   |","L L→LS        |","C ¬S4,S4→CR   |","R BΩ(A=0)→B   |","R UNORM (CAR) |","----    ** ----","Next: 048c"}},
    {0x0489,  {"---------- 0489","A L→L         |","A BC1B 1→FPSR4→F|","L FN,MD→LSA   |","L L→LS        |","C ¬S4,S4→CR   |","R       (CAR) |","----    X* ----","Next: 0492"}},
    {0x0327,  {"---------- 0327","|             |","| NOP         |","|             |","|             |","|             |","R W(67)→AB  0 |","----    ** ----","Next: 0c3c"}},
    
    // QG407
    {0x08d6,  {"---------- 08D6","A H→H         |","A       F→SR4 |","|             |","|             |","|             |","R 0        S5 |","----    X* ----","Next: 0480"}},
    {0x049a,  {"---------- 049A","E 0010        |","A -L→L        |","A BC8 L0,S4→  |","D MB+1        |","D CSTAT→ADDER |","C FPZERO,E→FN |","R 0     (CAR) |","----    X* ----","Next: 04d0"}},
    // QG408
    {0x04a8,  {"---------- 04A8","E 0100        |","A M→L         |","B LMB→U       |","B U→W         |","L FN,MD→LSA   |","L LS→R→LS     |","C E→BS        |","R BΩ(A=1)→B   |","R F=0      S7 |","----    ** ----","Next: 0cd0"}},
    {0x04a6,  {"---------- 04A6","E 0001        |","A H→H         |","A       SL4→F |","C S47.¬E      |","|             |","R UNORM    S0 |","----    ** ----","Next: 04a8"}},
    {0x08cf,  {"---------- 08CF","A R-1→R       |","A BC1B F→FPSL4|","D HOT1→ADDER  |","L FN,MD→LSA   |","L R→LS        |","C 1→LSGNS     |","R W=0   (CAR) |","----    ** ----","Next: 04ac"}},
    // QG416
    {0x0403,  {"---------- 0403","A M+L→R       |","A BC1B E→FPSL4|","R BΩ(A=0)→B   |","|             |","|             |","R UNORM (CAR) |","----    ** ----","Next: 048c"}},
    // QG701
    {0x0548,  {"---------- 0548","E 0001        |","A 0→L         |","A       SR1→F |","D MB-1        |","C S03.¬E      |","R F(2)      0 |","----    *X ----","Next: 054c"}},
    // QG800
    {0x059a,  {"---------- 059A","E 1101        |","A M-1→R       |","A BC1B F→FPSL4|","B MD,F→U      |","B U→W         |","B W→MMB       |","D HOT1→ADDER  |","L WS,E→LSA    |","L R→LS        |","C R(0)→RSGNS  |","R W=0   (CAR) |","----    ** ----","Next: 059c"}},
    // QG900
    {0x0ec7,  {"---------- 0EC7","E 1111        |","A R+L→R       |","A      Q→SL→-F|","D CSTAT→ADDER |","L WS,E→LSA    |","L LS→L→LS     |","R 0     (Z00) |","----    X* ----","Next: 03c0"}},
    {0x0523,  {"---------- 0523","E 0011        |","A L→R         |","B       E→WR  |","B WR→G2       |","L WS,E→LSA    |","L L→LS        |","C L(0)→LSGNS  |","R BΩ(A=0)→B   |","R UNORM TZ*BS |","----    ** ----","Next: 05a0"}},
    // QG902
    {0x03bc,  {"---------- 03BC","E 1011        |","A H-L→H       |","A BC0 SL1→Q   |","B MD,F→U MMB→V|","B VL→WL       |","B W→MMB       |","D MB+1        |","D HOT1,G-1    |","L WS,E→LSA    |","L LS→L→LS     |","C S03ΩE       |","R G1<0   G2<0 |","----    ** ----","Next: 0e48"}},
    {0x0ecc,  {"---------- 0ECC","A M→L         |","L FN,JΩ1→LSA  |","L L→LS        |","S IA+0/2→A    |","R SMIF        |","R I-FETCH     |","----    ** ----","Next: 0144"}},
    {0x0eca,  {"---------- 0ECA","A M→L         |","L FN,JΩ1→LSA  |","L L→LS        |","C 0→LSGNS     |","|             |","|             |","----    XX ----","Next: 0e0f"}},
    // QJ150
    {0x073e,  {"---------- 073E","A R→M         |","A       SR1→Q |","B R3→U        |","B U→W         |","B W67→LB      |","D 3→MB        |","L WS1→LSA     |","L L→LS        |","C L(0)→LSGNS  |","R MD3=0     0 |","----    *X ----","Next: 08c0"}},
    {0x0899,  {"---------- 0899","E 0010        |","A SGN→M       |","A       SR4→F |","D 0→MB        |","C E(13)→WFN   |","|             |","----    XX ----","Next: 021b"}},
    {0x089c,  {"---------- 089C","E 1111        |","A L→T         |","R BΩ(A=0)→B   |","|             |","|             |","R WR=0     S3 |","----    ** ----","Next: 0898"}},
    {0x089e,  {"---------- 089E","A R→L         |","A       SL1→Q |","L WS1→LSA     |","L LS→R→LS     |","|             |","|             |","----    XX ----","Next: 08ce"}},
    {0x089f,  {"---------- 089F","A -L→R        |","A BC0         |","D HOT1→ADDER  |","L FN,MD→LSA   |","L LS→L→LS     |","R 0      T(0) |","----    X* ----","Next: 08c4"}},
    {0x08a2,  {"---------- 08A2","A -L→R        |","A BC0         |","B       MMB→V |","B       VR→WR |","B WR→G2       |","D HOT1→ADDER  |","L WS1→LSA     |","L LS→L→LS     |","----    XX ----","Next: 08c1"}},
    {0x08a3,  {"---------- 08A3","A -L→R        |","A BC0         |","B       MMB→V |","B       VR→WR |","B WR→G2       |","D HOT1→ADDER  |","L WS1→LSA     |","L LS→L→LS     |","----    XX ----","Next: 08c3"}},
    {0x08c0,  {"---------- 08C0","E 0110        |","B       E→WR  |","B W→MD,F      |","|             |","|             |","|             |","----    XX ----","Next: 0195"}},
    {0x08c1,  {"---------- 08C1","A -L→L        |","A BC⩝C        |","D CSTAT→ADDER |","L WS1→LSA     |","L L→LS        |","|             |","----    XX ----","Next: 089e"}},
    {0x08c2,  {"---------- 08C2","E 0001        |","A M→M         |","A       SR1→Q |","B WR→F        |","D LB-1        |","L FN,MDΩ1→LSA |","L LS→L→LS     |","C E(13)→WFN   |","R L(0)   LB=0 |","----    ** ----","Next: 08a0"}},
    {0x08c4,  {"---------- 08C4","E 0001        |","A -L→L        |","A       -SGN→ |","B       MMB→V |","B       VR→WR |","D CSTAT→ADDER |","L FN,MDΩ1→LSA |","L R→LS        |","C E(23)→CR    |","----    XX ----","Next: 08c7"}},
    {0x08c5,  {"---------- 08C5","E 0001        |","A -L→L        |","A BC⩝C -SGN→  |","B       MMB→V |","B       VR→WR |","D CSTAT→ADDER |","L FN,MDΩ1→LSA |","L R→LS        |","C E(23)→CR    |","R       (CAR) |","----    X* ----","Next: 08c6"}},
    {0x08c7,  {"---------- 08C7","L FN,MD→LSA   |","L L→LS        |","|             |","|             |","|             |","R WR=0      1 |","----    *X ----","Next: 0881"}},
    {0x08ca,  {"---------- 08CA","A L→L         |","A       SL4→F |","B MD,F→U MMB→V|","B UL→WL ?→WR  |","B W→MMB       |","|             |","----    XX ----","Next: 08cd"}},
    {0x08cb,  {"---------- 08CB","A R→T         |","B MD,F→U MMB→V|","B UL→WL ?→WR  |","B W→MMB       |","L FN,MD→LSA   |","L R→LS        |","C SETCRALG    |","R BΩ(A=1)→B   |","R LSGNS  T(0) |","----    ** ----","Next: 089c"}},
    {0x08cc,  {"---------- 08CC","A L→R         |","B W→MMB       |","D G2-1        |","L WS1→LSA     |","L LS→L→LS     |","R        G2=0 |","----    X* ----","Next: 08ca"}},
    {0x08cd,  {"---------- 08CD","A R→R         |","A      F→SL4→F|","D G2-1        |","L FN,MDΩ1→LSA |","L L→LS        |","C (T=0)→S3    |","R        G2=0 |","----    X* ----","Next: 08ca"}},
    // QK666
    {0x094c,  {"---------- 094C","E 0011        |","A R→R,AW      |","D MB+1        |","C E(13)→WFN   |","|             |","|             |","----    XX ----","Next: 0954"}},
    {0x0995,  {"---------- 0995","E 0011        |","A M→R,AN      |","C E(13)→WFN   |","R BΩ(A=1)→B   |","|             |","R CANG   WR=0 |","----    ** ----","Next: 09bc"}},
    {0x09bc,  {"---------- 09BC","E 0001        |","B E→WL  UR→WR |","B W→CHCTL     |","D D→M         |","|             |","|             |","----    XX ----","Next: 0946"}},
    // QK702
    {0x094f,  {"---------- 094F","E 0011        |","C E(13)→WFN   |","|             |","|             |","|             |","R 0      HSCH |","----    X* ----","Next: 099c"}},
    {0x090c,  {"---------- 090C","D LB-1        |","|             |","|             |","|             |","|             |","R CHLOG     1 |","----    *X ----","Next: 093d"}},
    // QP010
    {0x0134,  {"---------- 0134","E 0001        |","A M23+L→L     |","B       MLB→V |","B V→W         |","B W→G         |","D 0→LB        |","L WS1→LSA     |","L L→LS        |","S IA+0/2→A    |","C E→S47       |","R AΩ(B=1)→A   |","R IA(30)   S7 |","----    ** ----","Next: 0640"}},
    // QP100
    {0x0614,  {"---------- 0614","A L→A         |","L WS2→LSA     |","L LS→R→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0626"}},
    // QP200
    {0x0d1c,  {"---------- 0D1C","B LLB→U       |","B U→W         |","C EDITSGN     |","|             |","|             |","R EDITPAT   0 |","----    *X ----","Next: 0d20"}},
    {0x0d20,  {"---------- 0D20","E 1111        |","B LLB→U       |","B E→WL  ?→WR  |","B W→MMB(E?)   |","S WR→IVD      |","R WL=0  RSGNS |","----    ** ----","Next: 0d24"}},
    {0x0d24,  {"---------- 0D24","E 1101        |","A R→R13       |","D MB+1        |","D HOT1,G-1    |","L WS2→LSA     |","L R→LS        |","C S03ΩE,1→LSGN|","R GZ/MB3    0 |","----    *X ----","Next: 0d3c"}},
    // QP203
    {0x0d33,  {"---------- 0D33","E 0001        |","A R→R13       |","B MD,F→U      |","B U→W         |","B W→MMB       |","D MB+1        |","D HOT1,G-1    |","C S03ΩE       |","R GZ/MB3    0 |","----    *X ----","Next: 0d3c"}},
    {0x0d3c,  {"---------- 0D3C","B       MMB→V |","C 1→BS*MB     |","|             |","|             |","|             |","R LSGNS    S3 |","----    ** ----","Next: 0d1c"}},
    // QP205
    {0x0e26,  {"---------- 0E26","E 0100        |","B LMB→U       |","B       VR→WR |","B W→MMB       |","L WS,E→LSA    |","L LS→L→LS     |","C IVD/RSGNS   |","----    XX ----","Next: 0e28"}},// QP206
    {0x0d95,  {"---------- 0D95","A R-1→L13     |","L FN,J→LSA    |","L L→LS        |","|             |","|             |","|             |","----    XX ----","Next: 0197"}},
    // QP810
    {0x060d,  {"---------- 060D","E 1000        |","A H+4→H       |","B LLB→U MMB→V |","B ?→W         |","B W→MMB       |","D LB,MB+1     |","D G-1         |","C E→BS        |","R BΩ(A=1)→B   |","R G<4    LB=3 |","----    ** ----","Next: 0680"}},
    // QP900
    {0x069e,  {"---------- 069E","A M+L→L,A     |","D 3→LB        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 068e"}},
    // QS114
    {0x0cc5,  {"---------- 0CC5","A M-L→T       |","D 3→MB        |","D HOT1→ADDER  |","L WS2→LSA     |","L LS→R→LS     |","R G2<=LB G2<0 |","----    ** ----","Next: 0c90"}},
    // QS118
    {0x0ca0,  {"---------- 0CA0","E 0001        |","C E(13)→WFN   |","R AΩ(B=1)→A   |","|             |","|             |","R 0       W=1 |","----    X* ----","Next: 0cc8"}},
    // QS200
    {0x0c24,  {"---------- 0C24","E 1000        |","D D→L         |","L WS,E→LSA    |","L L→LS        |","C 1→RSGNS     |","|             |","----    XX ----","Next: 0e0c"}},
    {0x0e82,  {"---------- 0E82","E 0100        |","A M+L→T       |","A DCBS        |","L WS,E→LSA    |","L LS→R→LS     |","|             |","----    XX ----","Next: 0e84"}},
    // QS302
    {0x0e27,  {"---------- 0E27","E 1011        |","A R→L         |","A       SL4→F |","B LLB→U       |","B U→W         |","L WS,E→LSA    |","L LS→R→LS     |","C L,RSGNS     |","----    XX ----","Next: 0ea1"}},
    // QS304
    {0x0eb1,  {"---------- 0EB1","E 0001        |","A R→R         |","A      F→SL4→F|","C S47ΩE       |","R BΩ(A=1)→B   |","R CSTAT    S5 |","----    ** ----","Next: 0e2c"}},
    {0x0e2c,  {"---------- 0E2C","E 0110        |","A M→H         |","A      F→SL4→F|","B WL→MD       |","L WS,E→LSA    |","L LS→L→LS     |","----    XX ----","Next: 0e96"}},
    {0x0e96,  {"---------- 0E96","A R-L→R       |","A DC0         |","D HOT1→ADDER  |","|             |","|             |","|             |","----    XX ----","Next: 0eb0"}},
    // QS308
    {0x0e31,  {"---------- 0E31","A H→L         |","A      F→SL4→F|","R AΩ(B=0)→A   |","|             |","|             |","R 0      G2<0 |","----    X* ----","Next: 0e34"}},
    // QS400
    {0x0d05,  {"---------- 0D05","B LLB→U       |","B       VR→WR |","B W→MMB       |","D LB,MB-1     |","D G1,2-1      |","S WL→IVD      |","C L,RSGNS     |","R AΩ(B=1)→A   |","R G1MBZ G2LBZ |","----    ** ----","Next: 0d04"}},
    {0x0d04,  {"---------- 0D04","B LLB→U       |","B U→W         |","B W→MMB       |","D LB,MB-1     |","D G1,2-1      |","S W→IVD       |","R AΩ(B=1)→A   |","R G1MBZ G2LBZ |","----    ** ----","Next: 0d04"}},
    {0x0d09,  {"---------- 0D09","A M→R         |","A       SR4→F |","L WS,E→LSA    |","L R→LS        |","|             |","R 0       T=0 |","----    X* ----","Next: 0d4c"}},
    // QS402
    {0x0d9a,  {"---------- 0D9A","A R→R         |","A DDC0 Q→SL1→F|","|             |","|             |","|             |","|             |","----    XX ----","Next: 0d9b"}},
    
    // QS404
    {0x0da8,  {"---------- 0DA8","E 0001        |","A M→D*BS      |","L WS,E→LSA    |","L LS→R→LS     |","C S03ΩE,0→BS  |","R G1<0      1 |","----    *X ----","Next: 0d85"}},
    
    // QS600
    {0x06c8,  {"---------- 06C8","B LLB→U       |","B ?→W         |","B W→MMB       |","D LB,MB-1     |","D G1,2-1      |","L WS2→LSA     |","L LS→L→LS     |","C 1→BS*MB     |","R G1MBZ G2LBZ |","----    ** ----","Next: 06a0"}},
    {0x06a0,  {"---------- 06A0","A H-LWA→T     |","D HOT1→ADDER  |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 06c9"}},
    {0x06c9,  {"---------- 06C9","E 0011        |","L WS,E→LSA    |","L LS→L→LS     |","|             |","|             |","R 1     T13=0 |","----    X* ----","Next: 06b6"}},
    {0x06b6,  {"---------- 06B6","E 1111        |","B LLB→U       |","B E→WL  UR→WR |","B W→MMB(E?)   |","D MB-1        |","D G1-1        |","C 1→BS*MB     |","R G1MBZ     1 |","----    *X ----","Next: 06bd"}},
    {0x06b6,  {"---------- 06B6","E 1111        |","B LLB→U       |","B E→WL  UR→WR |","B W→MMB(E?)   |","D MB-1        |","D G1-1        |","C 1→BS*MB     |","R G1MBZ     1 |","----    *X ----","Next: 06bd"}},
    {0x06bd,  {"---------- 06BD","E 1111        |","B LLB→U       |","B E→WL  ?→WR  |","B W→MMB(E?)   |","D LB,MB-1     |","D G1,2-1      |","C 1→BS*MB     |","R G1MBZ G2LBZ |","----    ** ----","Next: 06a4"}},
    {0x06a4,  {"---------- 06A4","E 1111        |","B LLB→U       |","B E→WL  UR→WR |","B W→MMB(E?)   |","D MB-1        |","D G1-1        |","C 1→BS*MB     |","R G1MBZ     1 |","----    *X ----","Next: 06bd"}},
    {0x06bd,  {"---------- 06BD","E 1111        |","B LLB→U       |","B E→WL  ?→WR  |","B W→MMB(E?)   |","D LB,MB-1     |","D G1,2-1      |","C 1→BS*MB     |","R G1MBZ G2LBZ |","----    ** ----","Next: 06a4"}},
    // QT105
    {0x0146,  {"---------- 0146","E 1111        |","B W→G         |","C E(23)→LSFN  |","|             |","|             |","R 1       IVA |","----    X* ----","Next: 014e"}},
    {0x0144,  {"---------- 0144","E 1110        |","L WS,E→LSA    |","L LS→L→LS     |","S IA+0/2→A    |","C E→S47       |","R I-FETCH     |","----    ** ----","Next: 0148"}},
    // QT110
    {0x0148,  {"---------- 0148","E 1111        |","A LRL→MLJK    |","B W67→LB      |","D 3→MB        |","C E(23)→LSFN  |","R BΩ(A=1)→B   |","R 1SYLS   IVA |","----    ** ----","Next: 0184"}},
    {0x014a,  {"---------- 014A","E 1111        |","B W→G         |","C E(23)→LSFN  |","|             |","|             |","R 1       IVA |","----    X* ----","Next: 014e"}},
    // QT115
    {0x014f,  {"---------- 014F","E 0101        |","A 0→MLJK      |","B       E→WR  |","B WR→F        |","C IA+2        |","|             |","----    XX ----","Next: 0195"}},
    {0x0184,  {"---------- 0184","E 1110        |","B W→G         |","D D→MHL       |","D MB-1        |","L WS,E→LSA    |","L L→LS        |","C B0,1SYL     |","----    XX ----","Next: 0188"}},
    {0x0187,  {"---------- 0187","E 1111        |","A M→MD        |","B W→G         |","D LB+1        |","C IA+2/4 E→BS |","R M(03)→ROAR  |","----****XX ----","Next: 0100"}},
    // NOTE: doc shows IA/2+4
    {0x0188,  {"---------- 0188","E 1111        |","A M→MD        |","B       MMB→V |","B       VR→WR |","B W→MMB       |","D LB,MB+1     |","L FN,MD→LSA   |","L LS→L→LS     |","C IA+2/4 E→BS |","R M(03)→ROAR  |","R RX.S0    S1 |","----****** ----","Next: 0100"}},
    // QT120
    {0x0102,  {"---------- 0102","E 1111        |","A R→IA        |","B W67→LB      |",
        "D IA→H        |",
        "D 3→MB        |",
        "C E(23)→LSFN  |",
        "R AΩ(B=1)→A   |",
        "R S3      IVA |","----    ** ----","Next: 01cc"}},
    {0x018b,  {"---------- 018B","E 0110        |","A 0→MLJK      |","B       E→WR  |","B WR→F        |","C IA+2        |","|             |","----    XX ----","Next: 0195"}},
    {0x01cc,  {"---------- 01CC","E 1110        |","B W→G         |","D D→MLJK      |","D MB-1        |","L WS,E→LSA    |","L L→LS        |","C E→S47       |","R BΩ(A=1)→B   |","R R(31)     0 |","----    *X ----","Next: 0188"}},
    {0x01cf,  {"---------- 01CF","E 0101        |","A 0→MLJK      |","B       E→WR  |","B WR→F        |","C IA+2        |","|             |","----    XX ----","Next: 0195"}},
    {0x01ce,  {"---------- 01CE","B W→G         |","D D→L         |","D LB+1        |","C B0,1SYL     |","R R(31)     1 |","|             |","----    *X ----","Next: 0189"}},
    // QT200
    {0x0106,  {"---------- 0106","E 1111        |","A H→R,AN      |","B WR→F        |","C E→BS,T30→S3 |","|             |","|             |","----    XX ----","Next: 0102"}},
    {0x0103,  {"---------- 0103","A R→IA        |","C 1→REFETCH   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"}},
    {0x0191,  {"---------- 0191","A 0→M,SP      |","D IA→H        |","D 3→LB,MB     |","C OPPANEL→S47 |","R BΩ(A=1)→B   |","R EXT,CHIRPT  |","----    *X ----","Next: 018c"}},
    {0x018c,  {"---------- 018C","A H→R         |","D LB-1        |","|             |","|             |","|             |","R S4       S5 |","----    ** ----","Next: 0208"}},
    {0x0208,  {"---------- 0208","|             |","| NOP         |","|             |","|             |","|             |","R S6       S7 |","----    ** ----","Next: 0150"}},
    {0x0150,  {"---------- 0150","C MANUAL→STOP |","|             |","|             |","|             |","|             |","R 0       EXC |","----    X* ----","Next: 0190"}},
    {0x0190,  {"---------- 0190","E 0111        |","D IA→H        |","L WS,E→LSA    |","L LS→L→LS     |","|             |","|             |","----    XX ----","Next: 0193"}},
    {0x0147,  {"---------- 0147","A 0→M,SP      |","D IA→H        |","D 3→LB,MB     |","C OPPANEL→S47 |","R BΩ(A=1)→B   |","R EXT,CHIRPT  |","----    *X ----","Next: 018c"}},
    {0x0152,  {"---------- 0152","B WR→F        |","D AKEY→R      |","C MANUAL→STOP |","|             |","|             |","|             |","----    XX ----","Next: 0103"}},
    {0x0209,  {"---------- 0209","D AKEY→L      |","C MANUAL→STOP |","R S6        0 |","|             |","|             |","|             |","----    *X ----","Next: 0154"}},
    {0x0156,  {"---------- 0156","D DKEY→T      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"}},
    {0x0107,  {"---------- 0107","C SYNC→OPPANEL|","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0106"}},
    {0x0193,  {"---------- 0193","A L→M,SP      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0106"}},
    // QT210
    {0x018f,  {"---------- 018F","E 0101        |","B E→WL  UR→WR |","B W→MMB       |","|             |","|             |","R TIMUP     1 |","----    *X ----","Next: 01a1"}},
    {0x01a3,  {"---------- 01A3","A M→R         |","B W→MMB       |","D MB-1        |","L WS1→LSA     |","L R→LS        |","|             |","----    XX ----","Next: 0198"}},
    {0x01a5,  {"---------- 01A5","A L→D         |","C 1→TIMERIRPT |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01a8"}},
    {0x0198,  {"---------- 0198","E 0110        |","A R→A         |","B       E→WR  |","B W→MMB       |","|             |","|             |","----    XX ----","Next: 01a0"}},
    {0x01a0,  {"---------- 01A0","A M→L         |","B WR→F        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01a4"}},
    {0x01a4,  {"---------- 01A4","D D→R         |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01cb"}},
    // QT220
    {0x020f,  {"---------- 020F","D DKEY→T      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02bf"}},
    {0x02bf,  {"---------- 02BF","D AKEY→R,AN   |","C F→KEY       |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"}},
    {0x020a,  {"---------- 020A","C MANUAL→STOP |","R BΩ(A=0)→B   |","R S6       S7 |","|             |","|             |","|             |","----    ** ----","Next: 020c"}},
    {0x020e,  {"---------- 020E","D AKEY→R,AN   |","C KEY→F       |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02bb"}},
    {0x02bb,  {"---------- 02BB","|             |","| NOP         |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02be"}},
    {0x02be,  {"---------- 02BE","C KEY→F       |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0191"}},
    {0x020d,  {"---------- 020D","D AKEY→R,AN   |","R S7        1 |","|             |","|             |","|             |","|             |","----    *X ----","Next: 0235"}},
    // QT300
    {0x0142,  {"---------- 0142","E 0100        |","B       E→WR  |","B W→MD,F      |","|             |","|             |","|             |","----    XX ----","Next: 0195"}},
    // QT310
    {0x010e,  {"---------- 010E","E 1100        |","A M→D         |","C E→SCANCTL   |","|             |","|             |","|             |","----    XX ----","Next: 010f"}},
    {0x010f,  {"---------- 010F","A R+L→R,A     |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0751"}},
    {0x0195,  {"---------- 0195","E 1010        |","A E→R         |","A       SL1→Q |","|             |","|             |","|             |","----    XX ----","Next: 019c"}},
    {0x01b3,  {"---------- 01B3","A H→M         |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 01b5"}},
    {0x01b4,  {"---------- 01B4","A R→R,A       |","B W→MMB       |","D 3→MB        |","|             |","|             |","|             |","----    XX ----","Next: 01b8"}},
    {0x01b5,  {"---------- 01B5","A L→A         |","B PSW4→U      |","B U→W         |","B W→MMB       |","|             |","|             |","----    XX ----","Next: 01b7"}},
    {0x01b7,  {"---------- 01B7","E 0010        |","A E→L         |","A       SL4→F |","L WS1→LSA     |","L LS→R→LS     |","|             |","----    XX ----","Next: 010e"}},
    {0x01b8,  {"---------- 01B8","A R+4→L       |","B MD,F→U      |","B U→W         |","B W→MMB       |","L WS1→LSA     |","L R→LS        |","----    XX ----","Next: 01b1"}},
    // QU100
    {0x0242,  {"---------- 0242","E 1000        |","A 0→L         |","C SCAN*E,00   |","|             |","|             |","|             |","----    XX ----","Next: 02ba"}},
    {0x02ba,  {"---------- 02BA","A 0→H         |","D 3→MD        |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 02b2"}},
    {0x0240,  {"---------- 0240","E 1000        |","A 0→L         |","D 3→MD        |","C T→PSW,IPL→T |","|             |","|             |","----    XX ----","Next: 02af"}},
    {0x02af,  {"---------- 02AF","E 1111        |","A 0→H         |","L WS1→LSA     |","L L→LS        |","C E→S03       |","|             |","----    XX ----","Next: 02b2"}},
    {0x02c2,  {"---------- 02C2","E 1000        |","A 0→L         |","D 0→MD        |","C SCAN*E,00   |","|             |","|             |","----    XX ----","Next: 02af"}},
    {0x02b2,  {"---------- 02B2","A 0→M,SP      |","B WL→J        |","D 0→LB,MB     |","C SCAN*E,00   |","R AΩ(B=0)→A   |","R PSS       0 |","----    *X ----","Next: 0280"}},
    {0x0282,  {"---------- 0282","E 0111        |","A -1→R        |","B       E→WR  |","B W→MMB       |","C E(0)→IBFULL |","|             |","----    XX ----","Next: 02d0"}},
    {0x02d0,  {"---------- 02D0","A 0→IA        |","B R3→U        |","B U→W         |","B W,E→A(BUMP) |","D 3→LB        |","L FN,J→LSA    |","L LS→L→LS     |","C E(23)→LSFN  |","----    XX ----","Next: 02b3"}},
    {0x02d1,  {"---------- 02D1","E 0010        |","B R3→U        |","B U→W         |","B W,E→A(BUMP) |","D 3→MB        |","L FN,J→LSA    |","L LS→L→LS     |","C E(23)→LSFN  |","----    XX ----","Next: 02b3"}},
    {0x02b6,  {"---------- 02B6","A M→D         |","B W→G         |","|             |","|             |","|             |","R MB=3   LB=3 |","----    ** ----","Next: 02d0"}},
    {0x0241,  {"---------- 0241","A 0→D         |","B R3→U        |","B U→W         |","B WL→J        |","|             |","|             |","----    XX ----","Next: 02d0"}},
    {0x0243,  {"---------- 0243","E 0011        |","A 0→D         |","D 0→LB,MB     |","L FN,J→LSA    |","L LS→L→LS     |","C E→SCANCTL   |","R S3     MD=0 |","----    ** ----","Next: 0204"}},
    {0x0207,  {"---------- 0207","A 0→R,A       |","C MANUAL→STOP |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0751"}},
    {0x0204,  {"---------- 0204","A L→T         |","B LLB→U       |","B U→W         |","B W→PSW0      |","C T→PSW       |","|             |","----    XX ----","Next: 0150"}},
    // QW111
    {0x0204,  {"---------- 0204","A L→T         |","B LLB→U       |","B U→W         |","B W→PSW0      |","C T→PSW       |","|             |","----    XX ----","Next: 0150"}},
    {0x0001,  {"---------- 0001","A R-L→T       |","A undef!!!AD  |","L undef!!!WS  |","|             |","|             |","|             |","----    XX ----","Next: 003c"}},
    {0x0010,  {"---------- 0010","A undef!!!AD  |","L undef!!!WS  |","L LS→R→LS     |","|             |","|             |","|             |","----    XX ----","Next: 0aab"}},
    {0x0202,  {"---------- 0202","D AKEY→A      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0203"}},
    {0x0203,  {"---------- 0203","D AKEY→IA     |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0205"}},
    {0x0205,  {"---------- 0205","D DKEY→L      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 020c"}},
    {0x020c,  {"---------- 020C","D DKEY→R      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 021f"}},
    {0x021f,  {"---------- 021F","D DKEY→H      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0283"}},
    {0x0283,  {"---------- 0283","D DKEY→M      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02aa"}},
    {0x02aa,  {"---------- 02AA","D DKEY→D      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02ab"}},
    {0x02ab,  {"---------- 02AB","D DKEY→J      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 02ae"}},
    {0x02ae,  {"---------- 02AE","D DKEY→MD     |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0202"}},
    {0x0200,  {"---------- 0200","D DKEY→D      |","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0200"}},
    // Has MD/1 instead of MD+1, missing R->Z
    // "0201,  {"---------- 0201","A AR->Z and D DKEY→L      |","D MD+1        |","L FN,MD→LSA   |","L LS→R,L→LS   |","|             |","|             |","----    XX ----","Next: 0201"}},
    
    // QW222: all 1"s and all 0"s
    // QY110
    {0x0f49,  {"---------- 0F49","|             |","| NOP         |","R D→ROAR,SCAN |","|             |","|             |","|             |","----****XX ----","Next: 0f41"}},
    {0x0fbe,  {"---------- 0FBE","A M→D         |","A      F→SL1→F|","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f8b"}},
    {0x0f8b,  {"---------- 0F8B","E 1000        |","C E→SCANCTL   |","|             |","|             |","|             |","R D(7)      1 |","----    *X ----","Next: 0f49"}},
    // QY150
    {0x0fd3,  {"---------- 0FD3","A R→A         |","B LLB→U       |","B U→W         |","B W→G         |","D G-1         |","S IA/4→A,IA   |","----    XX ----","Next: 0f0b"}},
    // QY310
    {0x0f48,  {"---------- 0F48","E 1000        |","D D→IAR       |","C SCAN*E,00   |","|             |","|             |","|             |","----    XX ----","Next: 0fb1"}},
    {0x0fb1,  {"---------- 0FB1","S IA+0/2→A    |","C SCAN*E,00   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fb0"}},
    {0x0f31,  {"---------- 0F31","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fb0"}},
    {0x0fb0,  {"---------- 0FB0","B       SEMT  |","D D→MLJK      |","D 3→LB        |","C E→BS        |","|             |","|             |","----    XX ----","Next: 0f30"}},
    {0x0f48,  {"---------- 0F48","E 1000        |","D D→IAR       |","C SCAN*E,00   |","|             |","|             |","|             |","----    XX ----","Next: 0fb1"}},
    {0x0fb1,  {"---------- 0FB1","S IA+0/2→A    |","C SCAN*E,00   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fb0"}},
    {0x0fb0,  {"---------- 0FB0","B       SEMT  |","D D→MLJK      |","D 3→LB        |","C E→BS        |","|             |","|             |","----    XX ----","Next: 0f30"}},
    {0x0f30,  {"---------- 0F30","A L→L         |","A       SL1→Q |","B LLB→U       |","B U→W         |","B W27→PSW4    |","D LB-1        |","S IA/4→A,IA   |","----    XX ----","Next: 0faf"}},
    {0x0faf,  {"---------- 0FAF","B       SEMT  |","B LLB→U       |","B U→W         |","B WR→F        |","D D→M,SP      |","D 0→LB        |","C E→S47       |","----    XX ----","Next: 0f2f"}},
    {0x0f2f,  {"---------- 0F2F","A L→L         |","A       SR4→H |","B LLB→U       |","B U→W         |","B WR→G2       |","S IA/4→A,IA   |","----    XX ----","Next: 0fae"}},
    {0x0fae,  {"---------- 0FAE","B       SEMT  |","B LLB→U       |","B U→W         |","B W67→MB      |","D D→L         |","C E(13)→WFN   |","----    XX ----","Next: 0f2e"}},
    {0x0f2d,  {"---------- 0F2D","A L→T         |","A      Q→SR1→Q|","B       MLB→V |","B V→W         |","B W→PSW0      |","S IA/4→A,IA   |","C L(0)→LSGNS  |","----    XX ----","Next: 0fac"}},
    {0x0fac,  {"---------- 0FAC","B       SEMT  |","D D→R         |","C E(23)→LSFN  |","|             |","|             |","|             |","----    XX ----","Next: 0f2c"}},
    {0x0f2c,  {"---------- 0F2C","A H→R         |","B R3→U        |","B U→W         |","B W67→LB      |","S IA/4→A,IA   |","C 1→IOMODE    |","----    XX ----","Next: 0fab"}},
    {0x0f2e,  {"---------- 0F2E","A M+64C→M     |","A BC0 Q→SR1→Q |","D 3→LB        |","S IA/4→A,IA   |","C X0,B0,1SYL  |","|             |","----    XX ----","Next: 0fad"}},
    {0x0fad,  {"---------- 0FAD","B       SEMT  |","B LLB→U       |","B U→W         |","B WL→G1       |","D D→H         |","C E→S03       |","----    XX ----","Next: 0f2d"}},
    {0x0fa9,  {"---------- 0FA9","D D→L         |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f29"}},
    {0x0f29,  {"---------- 0F29","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fa8"}},
    {0x0f08,  {"---------- 0F08","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f28"}},
    // QY410
    {0x0f89,  {"---------- 0F89","E 1100        |","C SCAN*E,00   |","|             |","|             |","|             |","R LOG       1 |","----    *X ----","Next: 0f55"}},
    {0x0f55,  {"---------- 0F55","S HA→A        |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f17"}},
    {0x0f17,  {"---------- 0F17","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fa6"}},
    {0x0fa6,  {"---------- 0FA6","E 0100        |","S HA→A        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f26"}},
    {0x0f26,  {"---------- 0F26","E 1100        |","S IA/4→A,IA   |","C SCAN*E,00   |","|             |","|             |","|             |","----    XX ----","Next: 0f57"}},
    {0x0fa2,  {"---------- 0FA2","E 0101        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f22"}},
    {0x0f22,  {"---------- 0F22","E 0110        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0fa1"}},
    {0x0fa1,  {"---------- 0FA1","E 0110        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f21"}},
    {0x0f21,  {"---------- 0F21","E 0111        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0fa0"}},
    {0x0fa0,  {"---------- 0FA0","E 0111        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f20"}},
    {0x0f20,  {"---------- 0F20","E 0001        |","D 0→LB        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","----    XX ----","Next: 0fbd"}},
    {0x0fbd,  {"---------- 0FBD","E 0001        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","R LOG       1 |","----    *X ----","Next: 0f85"}},
    {0x0f85,  {"---------- 0F85","|             |","| NOP         |","|             |","|             |","|             |","R PSS       1 |","----    *X ----","Next: 0f09"}},
    {0x0f87,  {"---------- 0F87","E 0001        |","S HA→A        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f9f"}},
    {0x0f9f,  {"---------- 0F9F","E 0001        |","D D→L         |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0fbf"}},
    {0x0fbf,  {"---------- 0FBF","D SCAN→D      |","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f9e"}},
    {0x0f9e,  {"---------- 0F9E","E 0001        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f09"}},
    // QY420
    {0x0f22,  {"---------- 0F22","E 0110        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0fa1"}},
    {0x0fa1,  {"---------- 0FA1","E 0110        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f21"}},
    {0x0f21,  {"---------- 0F21","E 0111        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0fa0"}},
    {0x0fa0,  {"---------- 0FA0","E 0111        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f20"}},
    {0x0f20,  {"---------- 0F20","E 0001        |","D 0→LB        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","----    XX ----","Next: 0fbd"}},
    {0x0fbd,  {"---------- 0FBD","E 0001        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","R LOG       1 |","----    *X ----","Next: 0f85"}},
    {0x0f85,  {"---------- 0F85","|             |","| NOP         |","|             |","|             |","|             |","R PSS       1 |","----    *X ----","Next: 0f09"}},
    {0x0f87,  {"---------- 0F87","E 0001        |","S HA→A        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f9f"}},
    {0x0f9f,  {"---------- 0F9F","E 0001        |","D D→L         |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0fbf"}},
    {0x0fbf,  {"---------- 0FBF","D SCAN→D      |","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f9e"}},
    {0x0f9e,  {"---------- 0F9E","E 0001        |","D FOLD→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f09"}},
    {0x0f09,  {"---------- 0F09","E 1100        |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0f32"}},
    {0x0f32,  {"---------- 0F32","E 1100        |","D SCAN→D      |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f9d"}},
    {0x0f9d,  {"---------- 0F9D","E 1101        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f38"}},
    {0x0f38,  {"---------- 0F38","E 1110        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f9c"}},
    {0x0f9c,  {"---------- 0F9C","E 1001        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f18"}},
    {0x0f18,  {"---------- 0F18","E 1010        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f9b"}},
    {0x0f9b,  {"---------- 0F9B","E 1011        |","D SCAN→D      |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f1b"}},
    {0x0f1b,  {"---------- 0F1B","E 0100        |","C E→S03       |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f1a"}},
    {0x0f1a,  {"---------- 0F1A","E 0010        |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0f99"}},
    {0x0f99,  {"---------- 0F99","D SCAN→D      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f19"}},
    {0x0f19,  {"---------- 0F19","E 0011        |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0f98"}},
    {0x0f98,  {"---------- 0F98","E 0010        |","D SCAN→D      |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 0fc9"}},
    {0x0fc9,  {"---------- 0FC9","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f97"}},
    {0x0f97,  {"---------- 0F97","D SCAN→D      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fc7"}},
    {0x0fc7,  {"---------- 0FC7","E 0010        |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0f96"}},
    {0x0f96,  {"---------- 0F96","E 0001        |","D SCAN→D      |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 0f56"}},
    {0x0f56,  {"---------- 0F56","S IA/4→A,IA   |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f16"}},
    {0x0f16,  {"---------- 0F16","D SCAN→D      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fc6"}},
    
    // QY430
    {0x0f16,  {"---------- 0F16","D SCAN→D      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fc6"}},
    {0x0fc6,  {"---------- 0FC6","E 0011        |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0f95"}},
    {0x0f95,  {"---------- 0F95","E 1100        |","D SCAN→D      |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 0f3c"}},
    {0x0fc6,  {"---------- 0FC6","E 0011        |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0f95"}},
    {0x0f95,  {"---------- 0F95","E 1100        |","D SCAN→D      |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 0f3c"}},
    {0x0f3c,  {"---------- 0F3C","A 0→M         |","D 3→MB        |","S IA/4→A,IA   |","|             |","|             |","|             |","----    XX ----","Next: 0f15"}},
    {0x0f15,  {"---------- 0F15","E 1000        |","B E→W         |","B W→MMB       |","D SCAN→D      |","|             |","R LOG       1 |","----    *X ----","Next: 0f3d"}},
    {0x0f3d,  {"---------- 0F3D","E 0010        |","A L→L         |","A       SR4→F |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","----    XX ----","Next: 0f94"}},
    {0x0f3f,  {"---------- 0F3F","A M→A         |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0fbb"}},
    {0x0fbb,  {"---------- 0FBB","D D→L         |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f3d"}},
    {0x0f94,  {"---------- 0F94","E 1001        |","D SCAN→D      |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 0f54"}},
    {0x0f54,  {"---------- 0F54","A 0→M         |","D 3→MB        |","S IA/4→A,IA   |","|             |","|             |","|             |","----    XX ----","Next: 0f14"}},
    {0x0f14,  {"---------- 0F14","E 1010        |","D SCAN→D      |","C E→S03       |","|             |","|             |","|             |","----    XX ----","Next: 0f53"}},
    {0x0f53,  {"---------- 0F53","A L→L         |","A       SR1→F |","S IA/4→A,IA   |","|             |","|             |","|             |","----    XX ----","Next: 0f13"}},
    {0x0f39,  {"---------- 0F39","E 0011        |","A M→R         |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","----    XX ----","Next: 0f3e"}},
    {0x0f3e,  {"---------- 0F3E","E 1000        |","D SCAN→D      |","|             |","|             |","|             |","R PSS       0 |","----    *X ----","Next: 0f1c"}},
    {0x0f1c,  {"---------- 0F1C","C E→S03       |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f9a"}},
    {0x0f9a,  {"---------- 0F9A","E 0010        |","S IA/4→A,IA   |","C SCAN*E,10   |","|             |","|             |","|             |","----    XX ----","Next: 0f93"}},
    {0x0f93,  {"---------- 0F93","B W→MD,F      |","D SCAN→D      |","|             |","|             |","|             |","R LOG       1 |","----    *X ----","Next: 0f45"}},
    {0x0f47,  {"---------- 0F47","E 1000        |","A L→L         |","A       SR1→F |","B LMB→U       |","B U→W         |","B W→MMB       |","D MB-1        |","C SCAN*E,00   |","R 1      LB=0 |","----    X* ----","Next: 0fca"}},
    {0x0fca,  {"---------- 0FCA","A H→IA        |","C SCAN*E,00   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 09bb"}},
    {0x0fcb,  {"---------- 0FCB","E 0110        |","A L→L         |","A       SR1→F |","B LMB→U       |","B U→W         |","B W→MMB       |","D MB-1        |","C E→CH        |","----    XX ----","Next: 0fd2"}},
    {0x0fd2,  {"---------- 0FD2","B LMB→U       |","B U→W         |","B W→MMB       |","S HA→A        |","C SCAN*E,00   |","R S3        1 |","----    *X ----","Next: 0f05"}},
    {0x0f05,  {"---------- 0F05","A M→IA        |","B W→G         |","D 0→LB,MB     |","|             |","|             |","|             |","----    XX ----","Next: 019c"}},
    // QY440
    {0x0f07,  {"---------- 0F07","A -1→MD       |","D 0→LB,MB     |","C E(23)→LSFN  |","|             |","|             |","|             |","----    XX ----","Next: 0f92"}},
    {0x0f92,  {"---------- 0F92","E 0111        |","B       E→WR  |","B W→MMB       |","D LB+1        |","L FN,MD→LSA   |","L LS→L→LS     |","----    XX ----","Next: 0f52"}},
    {0x0f52,  {"---------- 0F52","E 0001        |","B LLB→U       |","B U→W         |","B W,E→A(BUMP) |","|             |","|             |","----    XX ----","Next: 0f12"}},
    {0x0f12,  {"---------- 0F12","E 1000        |","A 0→D         |","C E→BS        |","|             |","|             |","|             |","----    XX ----","Next: 0fd1"}},
    {0x0fd1,  {"---------- 0FD1","E 0010        |","B LLB→U       |","B U→W         |","B W,E→A(BUMP) |","|             |","|             |","----    XX ----","Next: 0f91"}},
    {0x0f91,  {"---------- 0F91","A M→D*BS      |","|             |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f05"}},
    
    // QY450
    {0x0f04,  {"---------- 0F04","|             |","| NOP         |","|             |","|             |","|             |","R SCPS      1 |","----    *X ----","Next: 0fc1"}},
    // QY510
    {0x0f84,  {"---------- 0F84","|             |","| NOP         |","|             |","|             |","|             |","R SCFS      0 |","----    *X ----","Next: 0f04"}},
    {0x0f4c,  {"---------- 0F4C","D D→IAR       |","C SCAN*E,00   |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f8f"}},
    {0x0fcd,  {"---------- 0FCD","E 0010        |","S HA→A        |","|             |","|             |","|             |","|             |","----    XX ----","Next: 0f8d"}},
    {0x0fcc,  {"---------- 0FCC","E 0001        |","S IA/4→A,IA   |","C E→SCANCTL   |","|             |","|             |","R STC=0     0 |","----    *X ----","Next: 0f48"}},
};

extern std::vector<std::string> labels_RY, labels_TC, labels_LX, labels_TR, labels_AD, labels_AL, labels_LU, labels_MV, labels_UL, labels_UR, labels_WM, labels_UP, labels_LB, labels_MB, labels_DG, labels_WS, labels_SF, labels_IV, labels_ZN, labels_SS, labels_ZF, labels_AB, labels_BB;

TEST_CASE( "lengths") {
  REQUIRE(labels_RY.size() == 6);
  REQUIRE(labels_TC.size() == 2);
  REQUIRE(labels_LX.size() == 8);
  REQUIRE(labels_TR.size() == 32);
  REQUIRE(labels_AD.size() == 13);
  REQUIRE(labels_AL.size() == 32);
  REQUIRE(labels_LU.size() == 8);
  REQUIRE(labels_MV.size() == 3);
  REQUIRE(labels_UL.size() == 4);
  REQUIRE(labels_UR.size() == 4);
  REQUIRE(labels_WM.size() == 16);
  REQUIRE(labels_UP.size() == 4);
  REQUIRE(labels_LB.size() == 2);
  REQUIRE(labels_MB.size() == 2);
  REQUIRE(labels_DG.size() == 8);
  REQUIRE(labels_WS.size() == 8);
  REQUIRE(labels_SF.size() == 8);
  REQUIRE(labels_IV.size() == 8);
  REQUIRE(labels_ZN.size() == 8);
  REQUIRE(labels_SS.size() == 59);
  REQUIRE(labels_ZF.size() == 13);
  REQUIRE(labels_AB.size() == 64);
  REQUIRE(labels_BB.size() == 32);
}

TEST_CASE( "decode") {
    for (auto it = begin (tests); it != end (tests); ++it) {
        Test test = *it;
        auto result = decode(test.address, microcode_data[test.address]);
        auto wanted = test.wantedOutput;
        
        // Don't check empty lines
        std::vector<std::string> filteredResult;
        std::vector<std::string> filteredWanted;
        std::copy_if(result.begin(), result.end(), std::back_inserter(filteredResult), [](const std::string& c) { return c !=  "|             |"; });
        std::copy_if(wanted.begin(), wanted.end(), std::back_inserter(filteredWanted), [](const std::string& c) { return c !=  "|             |"; });
        REQUIRE_THAT(filteredResult, Catch::Equals(filteredWanted));
    }
}
